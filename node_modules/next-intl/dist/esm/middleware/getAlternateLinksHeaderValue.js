import{getHost as t,getNormalizedPathname as e,isLocaleSupportedOnDomain as a,formatTemplatePathname as o}from"./utils.js";function n(t,e){return"<".concat(t,'>; rel="alternate"; hreflang="').concat(e,'"')}function l(l){var r,c;let{config:i,localizedPathnames:s,request:f,resolvedLocale:p}=l;const u=f.nextUrl.clone();function d(t,e){return s&&"object"==typeof s?o(t,s[p],s[e]):t}u.host=null!==(r=t(f.headers))&&void 0!==r?r:u.host,u.protocol=null!==(c=f.headers.get("x-forwarded-proto"))&&void 0!==c?c:u.protocol,u.pathname=e(u.pathname,i.locales);const h=i.locales.flatMap((t=>{function e(e){return"/"===e?"/".concat(t):"/".concat(t).concat(e)}let o;if(i.domains){return(i.domains.filter((e=>a(t,e)))||[]).map((a=>(o=new URL(u),o.port="",o.host=a.domain,o.pathname=d(o.pathname,t),t===a.defaultLocale&&"always"!==i.localePrefix||(o.pathname=e(o.pathname)),n(o.toString(),t))))}{let a;a=s&&"object"==typeof s?d(u.pathname,t):u.pathname,t===i.defaultLocale&&"always"!==i.localePrefix||(a=e(a)),o=new URL(a,u)}return n(o.toString(),t)}));if(!i.domains){const t=new URL(d(u.pathname,i.defaultLocale),u);h.push(n(t.toString(),"x-default"))}return h.join(", ")}export{l as default};
